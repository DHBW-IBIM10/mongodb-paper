\title{\papertitle}

\author{Rocco Schulz and Robert Wawrzyniak}
	
\publishers{Corporate State University\\Baden-Wuerttemberg - Stuttgart}

\date{
\vspace{0.6cm}
provided on 6 May 2013\\
\vspace{0.6cm}
School of: Business\\
\vspace{0.6cm}
Program: International Business Information Management\\
\vspace{0.6cm}
Course: WWI2010I\\
\vspace{0.6cm}
}





% DOCUMENT
\renewcommand{\baselinestretch}{1.5}\normalsize
\begin{document}
\pagestyle{scrheadings}

% roman numerals
\renewcommand{\thepage}{\Roman{page}}
% page numbers centered on top:
\chead{\pagemark}
\cfoot{}

%----------------------------------------------------------------------------
% Title Page
%----------------------------------------------------------------------------

% no page numbering
\thispagestyle{empty}
% include title page
\input{title_page}


%  \begin{abstract}
%  \vspace{1.6cm}
% % \textbf{\abstractname}: 
%  \end{abstract}


%----------------------------------------------------------------------------
% Table of Contents
%----------------------------------------------------------------------------
\tableofcontents
\newpage


%----------------------------------------------------------------------------
% Abbreviations
%----------------------------------------------------------------------------
% List needs to be indexed after each change.
% This is done by executing the following command:
% ~$ makeindex [filename].nlo -s nomencl.ist -o [filename].nls
\printnomenclature
\addcontentsline{toc}{section}{List of Abbreviations}
\input{nomenclature.tex}

\newpage

%----------------------------------------------------------------------------
% List Of Tables
%----------------------------------------------------------------------------
\listoftables
\addcontentsline{toc}{section}{\listtablename}
\newpage


%----------------------------------------------------------------------------
% List of Figures
%----------------------------------------------------------------------------
\listoffigures
\addcontentsline{toc}{section}{\listfigurename}
\newpage

%----------------------------------------------------------------------------
% List of Listings
%----------------------------------------------------------------------------
%\lstlistoflistings
\listoflistings
\addcontentsline{toc}{section}{List of Listings}
\newpage

% Arabic numerals for page numbering
\renewcommand{\thepage}{\arabic{page}}

% Set page number to 1: 
\setcounter{page}{1} 


%----------------------------------------------------------------------------
% Intro
%----------------------------------------------------------------------------
\section{Introduction}
\label{sec:introduction}

Introduction to NoSQL.

Business drivers that push nosql or big data
\begin{enumerate}
  \item growth of user-driven content and availability of sensors
  \footcite[Cf.][XVII]{Tiwari_2011}
  \item data is increasingly becoming semi-structured so that upfront schema
  definition commonly needed in RDBMS gets
  challenging\footcite[Cf.][XVII]{Tiwari_2011}
  \item 
\end{enumerate}

% These\footcite[Cf.][22]{Warden_2011} are\footcite[Cf.][23]{Tiwari_2011} just some
% dummy\footcite[Cf.][34]{Redmond_2012} references\footcite[][]{Chodorow_2011_tips}
% to test\footcite[Cf.][44]{Chodorow_2011_scaling} the bibliography\footcite[Cf.][44]{Ohiggins_2011}
% environement.\footcite[Cf.][]{mongo_manual}


\subsection{Objectives}
\label{sec:objectives}
%SMART - specific, measurable, achievable, relevant, timed

\begin{enumerate}
  \item Test installation of mongoDB
  \item Introduce basic usage (CRUD + simple analytics)
  \item Performance tests with large datasets
  \item Show programmatical usage of mongoDB in a Python web project
\end{enumerate}

\subsection{Methodology and Structure}
\label{sec:methodology}

Section \ref{sec:foundation} first provides a brief introduction to the bigger
context of NoSQL databases before explaining the concepts and exemplary use
cases of MongoDB as one representative of NoSQL databases.\\
The following sections focus on the usage of MongoDB. Section \ref{sec:setup}
covers the installation and basic configuration of MongoDB and
\autoref{sec:usage} shows how to run basic create, read, update and delete
operations (CRUD) on MongoDB in different environments such as the mongo shell,
with graphical tools or programmatically via a driver.
Most examples are based on a publicly available data set consistig of several
hundret thousand email messages to allow reproducability of exeplary
results.\\
Section \ref{sec:maintenance} completes the introduction to the topic by
providing essential information on monitoring and other maintenance related
concerns. Section \ref{sec:conclusion} finally concludes and gives a thourough
outlook on advanced topics and future developments of MongoDB.


%----------------------------------------------------------------------------
% Theoretical Foundation
%----------------------------------------------------------------------------
\newpage

\section{Foundation}
\label{sec:foundation}



\subsection{NoSQL Databases}
\label{sec:nosql}

\begin{enumerate}
  \item nosql describes a range of data store technologies that do not have an sql interface
  \item there are multiple types of nosql data stores, these are briefly introduced in the following sections
\end{enumerate}
Main differences between RDBS and noSQL should be listed to avoid that readers
look at things as if they were conventional databases. they are not.

\paragraph{Key-Value Stores}
\label{sec:nosql-key-value}
As the name implies a key-value store maps keys to values in a similar way as a
map or hashtable would in a high level programming
language.\footcite[Cf.][4]{Redmond_2012} Such data structures are very efficient
with an average algorithm running time of big O(1) for accessing data and
are hence often used for caching of data.\footcite[Cf.][p. 14 et sq.]{Tiwari_2011}
However they are not very useful when it is necessary to do queries that are
more complex than simply looking up a value for a given key.\\
There are various open source projects available, whereas memcached, Voldemort,
Redis and Riak belong to the more popular ones.\footcite[Cf.][4]{Redmond_2012}

 
\paragraph{Document Oriented Databases}
\label{sec:nosql-document}
Document oriented databases store documents which can contain a variety of
values which may be of any type, including sub-documents, so that nested 
structures can be created.\footcite[Cf.][p. 5 et sq.]{Redmond_2012}\\
These databases should not be confused with document management systems. Even
though binary documents can be stored as well, the word document in this context
refers to a structured set of keys and values that belong to a
document.\footcite[Cf.][p. 18 et sq.]{Tiwari_2011}.\\
Multiple documents form collections which can be queried. Document oriented
databases do not have a fixed schema and hence exhibit high flexibility.

Document oriented databases are not a new phenomenom as they have been around
for a few decades already. However recently a number of new open source document 
oriented databases like MongoDB and CouchDB have quickly become popular.\footcite[Cf.][p. 18 et sq.]{Tiwari_2011}


\paragraph{Graph Databases}
\label{sec:nosql-graph}
Graph databases are an excellent choice when dealing with highly interconnected
data. They consist of multiple nodes and relationships between these nodes.
Nodes as well as their relationships can contain additional information in the
form of key-value pairs.\footcite[Cf.][6]{Redmond_2012}\\
Graph databases facilitate rapid traversal through graphs by following
relationships. Well known representatives of this group of noSQL databases are
Neo4j\footnote{See \url{http://www.neo4j.org/}} and FlockDB\footnote{See
\url{https://github.com/twitter/flockdb}}.\footcite[Cf.][19]{Tiwari_2011}


\subsection{MongoDB}
\label{sec:mongodb}


``MongoDB is designed to be huge (the name mongo is extracted from the word
humongous). Mongo server configurations attempt to remain consistentâ€”if
you write something, subsequent reads will receive the same value (until the
next update). This feature makes it attractive to those coming from an RDBMS
background. It also offers atomic read-write operations such as incrementing
a value and deep querying of nested document structures. Using JavaScript
for its query language, MongoDB supports both simple queries and complex
mapreduce jobs.''\footcite[][6]{Redmond_2012}

MongoDB belongs to the group of document oriented noSQL databases and is written
in C++. It does not try to be a general purpose database but has been developed
with the philosophy ``One size does not fit all'' in mind.\footcite[Cf.][3]{Plugge_2010}

MongoDB differs from other document-oriented databases in its ability to easily
scale across several servers. This is possible with replication, where data is 
copied to other servers to provide redundancy or by sharding where large
collections are split into pieces to be distributed among all
nodes.\footcite[Cf.][165]{Redmond_2012}

\paragraph{Terminology}
The MongoDB terminology differs to the terms used in RDBMS due to the different
concepts. MongoDB works with documents instead of tables as opposed to conventional RDBMS.
A document is a single storage unit and multiple documents can be contained in a
collection. Documents are stored in BSON format which is a JSON based
specification.\footcite[Cf.][]{bson_spec}

Most terms can roughly be mapped to their SQL dependants. An overview of key terms
is provided in Tab. \ref{tab:sql-mongo-map}.

 %allows proper citation marks inside tables
\begin{table}[ht]
\begin{tabular*}{0.95\textwidth}{p{0.45\textwidth} p{0.45\textwidth}}
\toprule
\textbf{SQL Terms/Concepts} & \textbf{MongoDB Terms/Concept}\\
\midrule 
database & 	database\\
table 	 &	collection\\
row 	 &	document\\
column 	 &	field\\
index 	 &	index\\
table joins &	embedded documents and linking\\
primary key\newline Specify any unique column or column combination as primary
key.
		&
primary key\newline
In MongoDB, the primary key is automatically set to the \_id field.\\

\bottomrule 
\end{tabular*}
  \begin{savenotes}
  \caption[SQL terms mapped to MongoDB]{SQL terms mapped to
  MongoDB\footcite[][]{mongo_sql_comp} }
  \label{tab:sql-mongo-map}
  \end{savenotes}
\end{table}


\paragraph{Areas of application}
A design goal of MongoDB is high availability through
replication.\footcite[Cf.][3]{Plugge_2010}
MongoDB aims for good horizontal scalability, speed and simplicity. Transaction
support has been ommitted as a tradeoff in favor of these
attributes.\footcite[Cf.][5]{Plugge_2010}\\
MongoDB is hence a good fit for applications that require a fast and highly
available data store, which is one of the reasons why it is very popular for web
applications. Due to its document-oriented nature mongo is a good fit for
hierarical data such as category hierarchies and comments.\\
In MongoDB comments can be contained in their parent document as a
sub-collection. Support for threaded comments can be added by embedding comments
in their parent comment. As a result the whole comment thread can be obtained
 by simply retrieving the embedded collection of comments from an item.
In a relational database this could only be achieved by more sophisticated
queries that require joins.

As opposed to RDBMS, MongoDB does not have fixed formats for the items that
are to be stored. Differed types of objects with different sets of attributes
can easily be put into the same collection. \\
E-Commerce product catalog must have this capability in order to store information
of various articles. In relational databases this capability could be provided
via multiple table inheritance\footnote{TODO: do we need to explain this concept?}.
While this allows flexible structures, it also requires expensive join operations 
to retrieve all relevant attributes of a product.
``MongoDBâ€™s dynamic schema means that each document need not conform to the same
schema. As a result, the document for each product only needs to contain
attributes relevant to that product.''\footcite[][]{mongo_product_catalog}

    
\FloatBarrier
%----------------------------------------------------------------------------
% Hands on Mongo
%----------------------------------------------------------------------------
\clearpage
\section{Setting up MongoDB}
\label{sec:setup}

\subsection{Installation}
\label{sec:installation}

\paragraph{Windows}
\label{sec:installation-windows}
The latest version of MongoDB can be downloaded from \url{http://www.mongodb.org/downloads}.
After downloading, the archive needs to be extracted, e.g. to \texttt{C:\textbackslash \-mongo\-db-win32-x86\-\_64-[version]}.
Afterwards the environment needs to be set up by running the following sequence of commands in the
Windows Command Prompt.

\begin{listing}
    \begin{batcode}
cd \
:: rename folder
move C:\mongodb-win32-* C:\mongodb
:: create folder for data in default location
md data
md data\db
    \end{batcode}
    \caption{Commands to set up the MongoDB environment on Windows}
    \label{lst:win-setup}
\end{listing}

MongoDB can now be started by issuing the command \texttt{C:\textbackslash mongodb\textbackslash\- bin\textbackslash\- mongod.exe}.
Since version 2 it is also possible to run mongod as a service on Windows.\footcite[Cf.][]{mongo_install_win} Refer
to the online documentation for instructions on how to do 
this.\footnote{See \url{http://docs.mongodb.org/manual/tutorial/install-mongodb-on-windows/}}

\paragraph{Linux}
\label{sec:installation-linux}
Use your favorite package manager.
Most distributions do not ship the latest version of MongoDB. This paper describes the usage of
MongoDB version 2.4 which can be obtained from 10gens own repository if not available in the
Linux distribution. See \url{http://docs.mongodb.org/manual/installation/}

\subsection{Configuration}
\label{sec:configuration}

\begin{enumerate}
  \item basic configuration of the service (ports, memory usage, etc)
  \item advanced: sharding, performance optimization, indexing
  \item advanced: distribution among several network nodes
\end{enumerate}
    
    
\newpage
\section{Using MongoDB}
\label{sec:usage}

\subsection{Test Environment Setup}
\label{sec:test-environment}

The following usage scenarios will be based on a publicly available dataset.
This section describes how to obtain and load this dataset into the previously
installed MongoDB.

The Enron Email Corpus has been ported to MongoDB and can be obtained from
\url{http://mongodb-enron-email.s3-website-us-east-1.amazonaws.com/}.
The uncompressed dataset contains approximately 500,000 emails.
While this is a relatively small dataset it is sufficient for
testing basic features of the database.

Once the archive has been downloaded and unpacked it can be loaded into MongoDB
by using the command line tool
\texttt{mongorestore}.\footcite[Cf.][]{mongo_restore}
 On Linux, run the commands as shown in Lst. \ref{lst:load-enron}.

\begin{listing}
    \begin{bashcode}
    wget https://s3.amazonaws.com/mongodb-enron-email/enron_mongo.tar.bz2
    tar -xjvf enron_mongo.tar.bz2
    mongorestore --db enron --noobjcheck dump/enron_mail/
    \end{bashcode}
    \caption{Shell commands to download and load the enron email corpus into MongoDB on Linux}
    \label{lst:load-enron}
\end{listing}

Note that the loading process requires a running instance of the mongo server.
Verify that the import was successful by opening the mongo shell and typing
\texttt{show dbs}.
The output should contain a row with \texttt{enron 3.9521484375GB}\footnote{The
size of the database may differ due to different file systems}, which is the
database that has been created during the loading process.


\subsection{Command Line Interface}
\label{sec:usage-cli}

The command line interface for MongoDB is called the mongo shell and is the most powerfull
tool for operating on MongoDB databases. The shell language is JavaScript, so that own
functions and variables can be declared within the shell.
The following examples assume that the Enron email corpus has been loaded into the database \textit{enron}.
In order to start working on this database, type \texttt{use enron}.

\subsubsection{Read}
Before performing any read operations it is necessary to figure out what collections
there are in the enron database, that can be read from. This information can be accessed
via the command \texttt{show collections} as shown in Lst. \ref{lst:show-collections}

\begin{listing}
    \begin{javascriptcode}
> show collections
messages
system.indexes
    \end{javascriptcode}
    \caption{Command to get a list of available collections in the current database}
    \label{lst:show-collections}
\end{listing}

\paragraph{Making Queries}
In the mongo shell, the \texttt{find()} and \texttt{findOne()} functions can be used to
query for data.\footcite[Cf.][7]{mongo_crud_manual}
These queries are performed by calling them on any collection.
Obtaining all emails from the messages collection is e.g. done by running
\texttt{db.messages.find()}.

The syntax of the find command is as follows: \texttt{db.collection.find(
<query>, <projection> )}\\
The \texttt{<query>} argument is used for filtering and the \texttt{<projection>} is used to specify
or limit the fields that should be returned.
The projection is hence comparable to the \textit{SELECT} part of a SQL query and the
query parameter is combarable to the \textit{WHERE} clause of a SQL query.


The \texttt{findOne()} function is very similar, however it only returns the first
element that matches the query. Lst. \ref{lst:findone} shows the result of the
findOne query on the messages collection without a query document provided. The
second argument tells MongoDB to exclude the body field from the result. Setting
the projection object to \texttt{\{"subject":1\}} would tell MongoDB to exclude
all fields from the result except for body.

\begin{listing}
    \begin{javascriptcode}
> db.messages.findOne({}, {"body": 0})
{
    "_id" : ObjectId("4f16fc97d1e2d32371003e27"),
    "subFolder" : "notes_inbox",
    "mailbox" : "bass-e",
    "filename" : "450.",
    "headers" : {
        "X-cc" : "",
        "From" : "michael.simmons@enron.com",
        "Subject" : "Re: Plays and other information",
        "X-Folder" : "\\Eric_Bass_Dec2000\\Notes Folders\\Notes inbox",
        "Content-Transfer-Encoding" : "7bit",
        "X-bcc" : "",
        "To" : "eric.bass@enron.com",
        "X-Origin" : "Bass-E",
        "X-FileName" : "ebass.nsf",
        "X-From" : "Michael Simmons",
        "Date" : "Tue, 14 Nov 2000 08:22:00 -0800 (PST)",
        "X-To" : "Eric Bass",
        "Message-ID" : "<6884142.1075854677416.JavaMail.evans@thyme>",
        "Content-Type" : "text/plain; charset=us-ascii",
        "Mime-Version" : "1.0"
    }
}
    \end{javascriptcode}
    \caption{findOne query on the messages collection}
    \label{lst:findone}
\end{listing}

As can be seen from the output in Lst. \ref{lst:findone} there can also be nested documents
within one document. In this case the headers field contains an object with all header fields.
MongoDB allows querying for nested attributes as well. So in order to find out the percentage of
replies among all emails we could run a series of commands as shown in Lst. \ref{lst:query-percent-replies}.

\begin{listing}
    \begin{javascriptcode}
> nAll = db.messages.count()
501513
> nReply = db.messages.find({"headers.Subject": /Re:.*/}).count()
100195
> nReply / nAll * 100
19.978544923062813
    \end{javascriptcode}
    \caption[Calculating the percentage of replies]{Calculating the percentage of replies in the meessages collection within the mongo shell}
    \label{lst:query-percent-replies}
\end{listing}

Similarly it is possible to query for values which are stored in an array
instead of a subdocument.
If the array contains sub-documents it is also possible to query for specific
fields within the sub-documents.\footcite[Cf.][10]{mongo_crud_manual} This is
demonstrated in Lst. \ref{lst:array-query}

\begin{listing}
    \begin{javascriptcode}
//find documents with exactly this array in the tags attribute
db.inventory.find( { tags: ['fruit','food','citrus'] } )
//find documents that contain a 'fruit' element in their tags array
db.inventory.find( { tags: 'fruit'} )
//find documents that have 'fruit' as the first element in the tags array
db.inventory.find( {'tags.0': 'fruit'} )
//find documents where the memos field contains an array that contains at least one
//subdocument with the field 'by' with the value 'shipping'
db.inventory.find( {'memos.by': 'shipping'} )
    \end{javascriptcode}
    \caption{Array queries on an inventory collection}
    \label{lst:array-query}
\end{listing}

Besides using regular expressions as demonstrated in Lst. \ref{lst:query-percent-replies} MongoDB
offers a number of other query selectors for comparisons (see Tab. \ref{tab:query-selectors-compare}).

An exemplary query using the greater than (\$gt), less than (\$lt) and or (\$or) operator
is shown in Lst. \ref{lst:query-operators}.
This query selects all documents in the inventory collection which have a type attribute with
a value of 'food' and either have  a quantity attribute with a value above $100$ or a price attribute
with a value below $9.95$.

\begin{listing}
    \begin{javascriptcode}
db.inventory.find( { type:'food', $or:[ { qty:{ $gt:100} },{ price:{ $lt:9.95} } ]} )
    \end{javascriptcode}
    \caption[Exemplary usage of query operators]{Exemplary usage of query operators\footcite[][9]{mongo_crud_manual}}
    \label{lst:query-operators}
\end{listing}


\begin{savenotes}
\begin{table}[htbp]
\begin{tabular*}{\textwidth}{p{0.1\textwidth} p{0.85\textwidth}}
\toprule
\textbf{Name} 					& \textbf{Description}\\
\midrule 
\$all    & Matches arrays that contain all elements specified in the query. \\
\$gt     & Matches values that are greater than the value specified in the query.\\
\$gte    & Matches values that are equal to or greater than the value specified in the query.\\
\$in     & Matches any of the values that exist in an array specified in the query.\\
\$lt     & Matches vales that are less than the value specified in the query.\\
\$lte    & Matches values that are less than or equal to the value specified in the query.\\
\$ne     & Matches all values that are not equal to the value specified in the query.\\
\$nin    & Matches values that do not exist in an array specified to the query.\\
\bottomrule 
\end{tabular*}
  \caption[Query selectors for value comparison]{Query selectors for value comparison\footcite[][]{mongo_query_ops}}
  \label{tab:query-selectors-compare}
\end{table}
\end{savenotes}


\paragraph{Optimizing queries with indices}
When sorting a dataset MongoDB inspects all documents within the collection
to put them in the desired order. In large collections this can be very time
consuming and results in long response times.
MongoDB actually refuses to run queries which would take too long to complete as shown in
Lst. \ref{lst:no-index}.

\begin{listing}
    \begin{javascriptcode}
//find all emails and sort them ascending by the senders email address
> db.messages.find().sort({"headers.From":1})
error: {
    "$err" : "too much data for sort() with no index.  add an index or specify a smaller limit",
    "code" : 10128
}
    \end{javascriptcode}
    \caption{Trying to sort the messages collection by a non-indexed field}
    \label{lst:no-index}
\end{listing}

Just like in other databases indices can be created to improve the efficieny of
read operations.\footcite[Cf.][152 et sq.]{Redmond_2012} Indices can be created
using the \texttt{ensureIndex({<field1>: <order>, <field2>: <order>,... })}
function in the mongo shell.\footcite[Cf.][12]{mongo_crud_manual} 
The internal mechanisms behind indexing of MongoDB are beyond the scope of this
paper and can be read about in the official documentation.\footnote{See
\url{http://docs.mongodb.org/manual/core/indexes/}} An index for the
\textit{From} field in the embedded \textit{headers} document can be created
with \texttt{db.messages.ensureIndex({"headers.From":1})}, so that the query
shown in Lst. \ref{lst:no-index} can be executed. It is possible to display all
current indices by executing \texttt{getIndices()} as shown in Lst.
\ref{lst:showIndices}.

\begin{listing}
    \begin{javascriptcode}
> db.messages.getIndices()
[   {
        "v" : 1,
        "key" : { "_id" : 1 },
        "ns" : "enron.messages",
        "name" : "_id_"
    },
    {
        "v" : 1,
        "key" : { "headers.From" : 1 },
        "ns" : "enron.messages",
        "name" : "headers.From_1"
    } ]
    \end{javascriptcode}
    \caption{Showing all indices of the messages collection}
    \label{lst:showIndices}
\end{listing}

Further optimization strategies include query tuning, storing pre-calculated
data and restructuring document formats and are described in detail in
\citetitle{Chodorow_2011_tips} by
\citeauthor{Chodorow_2011_tips}.\footcite[Cf.][]{Chodorow_2011_tips}

\FloatBarrier
\subsubsection{Create}
Documents can be created with the \texttt{insert()} command in the mongo
shell.\\
Bulk inserts are also possible.\footcite[Cf.][p. 53 et sqq.]{mongo_crud_manual}

\subsubsection{Update}
Updates can be done with the \texttt{update()} command and the \texttt{save()}
command.\footcite[Cf.][p. 75 et. sqq.]{mongo_crud_manual}



\subsubsection{Delete}
Delete operations for one or multiple documents can be performed with
\texttt{db.collection.remove()}.\footcite[Cf.][p. 83 et.
sqq.]{mongo_crud_manual}


\subsection{Programmatically}
\label{sec:usage-programmatically}
\begin{enumerate}
  \item Using MongoDB as a module of a application is probably the most common usage scenario
  \item Interfaces for a large number of programming languages exist
  \item Some basic operations can be shown in Ruby, Java, Python, JavaScript
\end{enumerate}


\subsection{Graphical Interfaces}
\label{sec:usage-gui}
there are UI based admin tools by 3rd party developers\\
show a small selection of them

\newpage
\section{Maintaining MongoDB}
\label{sec:maintenance}

\subsection{Monitoring}
\label{sec:maintenance-monitroing}
Monitoring is an elementary part of database administration in order to avoid
incidents before they happen. MongoDB ships with separate tools for monitoring.
One of these is \texttt{mongotop} which can be used to get performance information
on collections level.\footcite[Cf.][]{mongo_monitoring}
\begin{listing}
    \begin{bashcode}
                            ns       total        read       write
2013-06-25T19:28:48
                enron.messages      1158ms      1158ms         0ms
          enron.system.indexes         0ms         0ms         0ms
       enron.system.namespaces         0ms         0ms         0ms
            enron.system.users         0ms         0ms         0ms
             local.startup_log         0ms         0ms         0ms
          local.system.indexes         0ms         0ms         0ms
    \end{bashcode}
    \caption{Output of mongotop}
    \label{lst:mongotop}
\end{listing}

Another command line tool for monitoring is \texttt{mongostat}, which provides
information on a higher level such as number of open connections,
memory consumption, network traffic and query throughput.\footcite[Cf.][]{mongo_monitoring}

Additionally it is possible to get these information via a web interface.
``In default configurations the REST interface is accessible on 28017. For
example, to access the REST interface on a locally running mongod instance:
\url{http://localhost:28017}''\footcite[][]{mongo_monitoring}
The REST interface is disabled by default and needs to be enabled by setting the
\texttt{rest} field to \texttt{true} in the configuration file.\footcite[Cf.][]{mongo_conf}\\
It is also possible to get these information from within the mongo shell via commands such as
\texttt{db.serverStatus()}. Additionally profiling information can be obtained when the
profiling is enabled. This can be done by setting the profiling level to $1$ or $2$ via
\texttt{db.setProfilingLevel(<level>)}. When set to $1$, all operations are profiled, when set
to $2$ only slow operations will be profiled.
A full list of available commands is available in the online
documentation.\footnote{See \url{http://docs.mongodb.org/manual/reference/command/\#diagnostic-commands}}

\subsection{Updating}
\label{sec:maintenance-updating}
TODO

\subsection{Security and Authentication}
\label{sec:maintenance-security}
It is recommended to run MongoDB in a trusted environment, to make sure that
only trusted machines may access the MongoDB
server.\footcite[Cf.][118]{Chodorow_2010}
If MongoDB is run on a server which is publicly accessible, it should be
run with the \texttt{--bindip} option to specify a local IP address that MongoDB
will be bound to (e.g. \texttt{--bindip localhost} to only allow
connections from an application on the same
machine).\footcite[Cf.][118]{Chodorow_2010}
Authentication in MongoDB can be enabled by either starting \texttt{mongod} with the \texttt{--auth} switch or by configuring it in the settings file with the line \texttt{auth = true}.
Users of a database are stored as documents in the system.users collection
within this database.\footcite[Cf.][TODO]{mongo_authentication}
User documents consist of the field ``user" which contains the username,
a ``readOnly" flag and a ``pwd" field which stores a hash of the
username and password. Lst. \ref{lst:mongo-auth} shows how one can
authenticate in the mongo shell and how new users can be added and removed from
a database.

%TODO: clarify wether users need to be created before setting auth to true
%TODO: listing is incomplete
\begin{listing}
    \begin{javascriptcode}
> use admin
switched to db admin
> db.addUser("root", "abcd");
{
"user" : "root",
"pwd" : "1a0f1c3c3aa1d592f490a2addc559383"
}
> use test
switched to db test
> db.addUser("test_user", "efgh");
{
"user" : "test_user",
"readOnly" : false,
"pwd" : "6076b96fc3fe6002c810268702646eec"
}
    \end{javascriptcode}
    \caption{User administration in the mongo shell}
    \label{lst:mongo-auth}
\end{listing}


%----------------------------------------------------------------------------
% Closing
%----------------------------------------------------------------------------

\newpage
\section{Conclusion and Outlook}
\label{sec:conclusion}

MongoDB strengths are its ability to handle large amounts of data as well as
large amounts of requests by replication and sharding. Additionally it allows
very flexible data models due to its schema-less storage model.\\
In \autoref{sec:usage} it has been shown that MongoDB is easy to use as its
query language shares many similarities with traditional SQL concepts.\\
MongoDB should not be seen as an alternative for conventional RDBS but as a
complementary module in application development. MongoDB encourages
denormalization of schemas by not having any. This goes along with less
constraints so that more caution is needed on the application development side.




%----------------------------------------------------------------------------
% APPENDIX
%----------------------------------------------------------------------------
% Appendix sections need to be within the subappendices environment.
% Use the command \appsection{title} instead of \section to introduce each
% appendix. This will add each appendix to the list of appendices.

% sets the appendix environment and resets the section counters
\newpage \begin{appendices} 
\appendixtocon %adds an 'Appendices' entry to the toc

\appendixpage %prints the title on the page

\subsection*{\listappendixname}
%--------------------------------
% style of the \listofappendices command is defined in header.tex
\listofappendices

% begin appendices on a new page
\newpage

%start environment for subappendices, so that new sections are formatted as
%subsections of appendix
\begin{subappendices}
\renewcommand{\setthesubsection}{\arabic{subsection}:}%

\appsection{Some Source Code}
\label{apx:placeholder}

% close the appendices environment
\end{subappendices}
\end{appendices}
